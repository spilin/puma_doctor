require 'puma_doctor'
require 'daemons'

Daemons.run_proc('puma_doctor', { dir: '<%= File.dirname(fetch(:puma_doctor_pid)) %>' }) do
  options = {
      frequency: <%= fetch(:puma_doctor_frequency) %>,
      memory_threshold: <%= fetch(:puma_doctor_memory_threshold) %>,
      puma_pid_file: '<%= fetch(:puma_pid) %>',
      log_file: '<%= fetch(:puma_doctor_log_file) %>'
    }
  PumaDoctor.start(options)
end
